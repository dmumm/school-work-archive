x="Year",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Danceability Vs Year
barYear <- aggregate(df1[, 13], list(df1$year), median)
p <- ggplot(barYear, aes(x=barYear$Group.1, y=barYear$x)) +
theme_bw() +
geom_point(size=3, col="orange") +
geom_smooth(method="loess", color = "black") +
labs(subtitle="Year vs Danceability",
y="Danceability",
x="Year",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Danceability Vs Peak Position
p <- ggplot(FDance, aes(x=df1$danceability, y=df1$peak_pos)) +
theme_bw() +
geom_point(size=1, col="orange") +
geom_smooth(method="lm", color = "black") +
labs(subtitle="Danceability Vs Peak Position",
y="Peak Position",
x="Danceability",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Danceability Vs Peak Position
p <- ggplot(df1, aes(x=df1$danceability, y=df1$peak_pos)) +
theme_bw() +
geom_point(size=1, col="orange") +
geom_smooth(method="lm", color = "black") +
labs(subtitle="Danceability Vs Peak Position",
y="Peak Position",
x="Danceability",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Danceability Vs Peak Position
p <- ggplot(df1, aes(x=df1$danceability, y=df1$peak_pos)) +
theme_bw() +
geom_point(size=1, col="orange") +
geom_smooth(method="gam", color = "black") +
labs(subtitle="Danceability Vs Peak Position",
y="Peak Position",
x="Danceability",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Danceability Vs Peak Position
p <- ggplot(df1, aes(x=df1$danceability, y=df1$peak_pos)) +
theme_bw() +
geom_point(size=1, col="orange") +
geom_smooth(method="loess", color = "black") +
labs(subtitle="Danceability Vs Peak Position",
y="Peak Position",
x="Danceability",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Danceability Vs Peak Position
p <- ggplot(df1, aes(x=df1$danceability, y=df1$peak_pos)) +
theme_bw() +
geom_point(size=1, col="orange") +
geom_smooth(method="gam", color = "black") +
xlim(.20, .9) +
labs(subtitle="Danceability Vs Peak Position",
y="Peak Position",
x="Danceability",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Danceability Vs Peak Position
p <- ggplot(df1, aes(x=df1$danceability, y=df1$peak_pos)) +
theme_bw() +
geom_point(size=1, col="orange") +
geom_smooth(method="loess", color = "black") +
xlim(.20, .9) +
labs(subtitle="Danceability Vs Peak Position",
y="Peak Position",
x="Danceability",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Danceability Vs Peak Position
p <- ggplot(df1, aes(x=df1$danceability, y=df1$peak_pos)) +
theme_bw() +
geom_point(size=1, col="orange") +
geom_smooth(method="loess", color = "black") +
xlim(.25, .9) +
labs(subtitle="Danceability Vs Peak Position",
y="Peak Position",
x="Danceability",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Duration Vs Peak Position
p <- ggplot(FDance, aes(x=df1$duration_ms / 1000, y=df1$peak_pos)) +
theme_bw() +
geom_point(size=1, col="#40E0D0") +
geom_smooth(method="loess", color = "black") +
xlim(150, 375) +
labs(subtitle="Duration Vs Peak Position",
y="Peak Position",
x="Duration (seconds)",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Duration Vs Peak Position
p <- ggplot(FDance, aes(x=df1$duration_ms / 1000, y=df1$peak_pos)) +
theme_bw() +
geom_point(size=1, col="#40E0D0") +
geom_smooth(method="loess", color = "black") +
xlim(150, 325) +
labs(subtitle="Duration Vs Peak Position",
y="Peak Position",
x="Duration (seconds)",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Danceability Vs Peak Position
p <- ggplot(df1, aes(x=df1$danceability, y=df1$peak_pos)) +
theme_bw() +
geom_point(size=1, col="orange") +
geom_smooth(method="loess", color = "black") +
xlim(.2, .9) +
labs(subtitle="Danceability Vs Peak Position",
y="Peak Position",
x="Danceability",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Duration Vs Peak Position
p <- ggplot(FDance, aes(x=df1$duration_ms / 1000, y=df1$peak_pos)) +
theme_bw() +
geom_point(size=1, col="#40E0D0") +
geom_smooth(method="loess", color = "black") +
xlim(150, 375) +
labs(subtitle="Duration Vs Peak Position",
y="Peak Position",
x="Duration (seconds)",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Duration Vs Peak Position
p <- ggplot(FDance, aes(x=df1$duration_ms / 1000, y=df1$peak_pos)) +
theme_bw() +
geom_point(size=1, col="#40E0D0") +
geom_smooth(method="gam", color = "black") +
xlim(150, 375) +
labs(subtitle="Duration Vs Peak Position",
y="Peak Position",
x="Duration (seconds)",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Duration Vs Peak Position
p <- ggplot(FDance, aes(x=df1$duration_ms / 1000, y=df1$peak_pos)) +
theme_bw() +
geom_point(size=1, col="#40E0D0") +
geom_smooth(method="gam", color = "black") +
xlim(150, 375) +
labs(subtitle="Duration Vs Peak Position",
y="Peak Position",
x="Duration (seconds)",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Duration Vs Peak Position
p <- ggplot(FDance, aes(x=df1$duration_ms / 1000, y=df1$peak_pos)) +
theme_bw() +
geom_point(size=1, col="#40E0D0") +
geom_smooth(method="loess", color = "black") +
xlim(150, 375) +
labs(subtitle="Duration Vs Peak Position",
y="Peak Position",
x="Duration (seconds)",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Duration Vs Peak Position
p <- ggplot(FDance, aes(x=df1$duration_ms / 1000, y=df1$peak_pos)) +
theme_bw() +
geom_point(size=1, col="#40E0D0") +
geom_smooth(method="loess", color = "black") +
xlim(150, 325) +
labs(subtitle="Duration Vs Peak Position",
y="Peak Position",
x="Duration (seconds)",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Duration Vs Peak Position
p <- ggplot(FDance, aes(x=df1$duration_ms / 1000, y=df1$peak_pos)) +
theme_bw() +
geom_point(size=1, col="#40E0D0") +
geom_smooth(method="loess", color = "black") +
xlim(150, 310) +
labs(subtitle="Duration Vs Peak Position",
y="Peak Position",
x="Duration (seconds)",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Valence Vs Peak Position
p <- ggplot(FDance, aes(x=df1$valence, y=df1$peak_pos)) +
theme_bw() +
geom_point(size=1, col="violet") +
geom_smooth(method="loess", color = "black") +
labs(subtitle="Valence Vs Peak Position",
y="Peak Position",
x="Valence",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Valence Vs Peak Position
p <- ggplot(FDance, aes(x=df1$valence, y=df1$peak_pos)) +
theme_bw() +
geom_point(size=1, col="violet") +
geom_smooth(method="gam", color = "black") +
labs(subtitle="Valence Vs Peak Position",
y="Peak Position",
x="Valence",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Danceability Vs Year
barYear <- aggregate(df1[, 13], list(df1$year), median)
p <- ggplot(barYear, aes(x=barYear$Group.1, y=barYear$x)) +
theme_bw() +
geom_point(size=3, col="orange") +
geom_smooth(method="loess", color = "black") +
labs(subtitle="Year vs Danceability",
y="Danceability",
x="Year",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Danceability Vs Year
barYear <- aggregate(df1[, 13], list(df1$year), median)
p <- ggplot(barYear, aes(x=barYear$Group.1, y=barYear$x)) +
theme_bw() +
geom_point(size=3, col="orange") +
geom_smooth(method="gam", color = "black") +
labs(subtitle="Year vs Danceability",
y="Danceability",
x="Year",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Danceability Vs Year
barYear <- aggregate(df1[, 13], list(df1$year), median)
p <- ggplot(barYear, aes(x=barYear$Group.1, y=barYear$x)) +
theme_bw() +
geom_point(size=3, col="orange") +
geom_smooth(method="loess", color = "black") +
labs(subtitle="Year vs Danceability",
y="Danceability",
x="Year",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Danceability Vs Year
barYear <- aggregate(df1[, 13], list(df1$year), median)
p <- ggplot(barYear, aes(x=barYear$Group.1, y=barYear$x)) +
theme_bw() +
geom_point(size=3, col="orange") +
geom_smooth(method="loess", color = "black", size=1) +
labs(subtitle="Year vs Danceability",
y="Danceability",
x="Year",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Danceability Vs Year
barYear <- aggregate(df1[, 13], list(df1$year), median)
p <- ggplot(barYear, aes(x=barYear$Group.1, y=barYear$x)) +
theme_bw() +
geom_point(size=3, col="orange") +
geom_smooth(method="loess", color = "black", size=.5) +
labs(subtitle="Year vs Danceability",
y="Danceability",
x="Year",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Duration Vs Year
barYear <- aggregate(df1[, 15], list(df1$year), median)
p <- ggplot(barYear, aes(x=barYear$Group.1, y=barYear$x / 1000)) +
theme_bw() +
geom_point(size=3, col="#40E0D0") +
geom_smooth(method="lm", color = "black", size =.5) +
labs(subtitle="Year vs Duration",
y="Duration",
x="Year",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Duration Vs Year
barYear <- aggregate(df1[, 15], list(df1$year), median)
p <- ggplot(barYear, aes(x=barYear$Group.1, y=barYear$x / 1000)) +
theme_bw() +
geom_point(size=3, col="#40E0D0") +
geom_smooth(method="lm", color = "grey", size =.5) +
labs(subtitle="Year vs Duration",
y="Duration",
x="Year",
title="",
caption = "Source: Billboard and Spotify")
print(p)
barYear <- aggregate(df1[, 17], list(df1$year), median)
p <- ggplot(barYear, aes(x=barYear$Group.1, y=barYear$x)) +
theme_bw() +
geom_point(size=3, col="violet") +
geom_smooth(method="lm", color = "grey", size = .5) +
labs(subtitle="Year vs Valence",
y="Median Valence",
x="Year",
title="",
caption = "Source: Billboard and Spotify")
print(p)
barYear <- aggregate(df1[, 15], list(df1$year), median)
p <- ggplot(barYear, aes(x=barYear$Group.1, y=barYear$x / 1000)) +
theme_bw() +
geom_point(size=3, col="#40E0D0") +
geom_smooth(method="lm", color = "grey", size =.5) +
labs(subtitle="Year vs Duration",
y="Duration",
x="Year",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Valence Vs Year
barYear <- aggregate(df1[, 17], list(df1$year), median)
p <- ggplot(barYear, aes(x=barYear$Group.1, y=barYear$x)) +
theme_bw() +
geom_point(size=3, col="violet") +
geom_smooth(method="loess", color = "grey", size = .5) +
labs(subtitle="Year vs Valence",
y="Median Valence",
x="Year",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Duration Vs Year
barYear <- aggregate(df1[, 15], list(df1$year), median)
p <- ggplot(barYear, aes(x=barYear$Group.1, y=barYear$x / 1000)) +
theme_bw() +
geom_point(size=3, col="#40E0D0") +
geom_smooth(method="loess", color = "grey", size =.5) +
labs(subtitle="Year vs Duration",
y="Duration",
x="Year",
title="",
caption = "Source: Billboard and Spotify")
print(p)
plot(df1$energy, df1$peak_pos)
gam1 <- glm(peak_pos ~ poly(energy, 2) + poly(liveness, 3) + poly(tempo,1)+ poly(acousticness,2) + poly(instrumentalness,3) + poly(time_signature,3)+ poly(danceability,2) + poly(duration_ms,3)+ poly(loudness,1)+ poly(valence,1), data = df1)
summary(gam1)
gam1 <- glm(peak_pos ~ poly(energy, 2) + poly(liveness, 3) + poly(tempo,1)+ poly(acousticness,2) + poly(instrumentalness,3) + poly(time_signature,3)+ poly(danceability,2) + poly(duration_ms,3)+ poly(loudness,1)+ poly(valence,1), data = df1)
summary(gam1)
gam2 <- gam(peak_pos ~ s(energy, 2) + s(liveness, 3) + s(tempo,1)+ s(acousticness,2) + s(instrumentalness,3) + s(time_signature,3)+ s(danceability,2) + s(duration_ms,3)+ s(loudness,1)+ s(valence,1), data = df1)
summary(gam2)
gam4 <- gam(peak_pos ~ s(liveness, 3) + s(tempo,1)+ s(acousticness,2) + s(instrumentalness,3) + s(time_signature,3)+ s(danceability,2) + s(duration_ms,3)+ s(loudness,1)+ s(valence,1), data = df1)
summary(gam4) # removed energy
gam4 <- gam(peak_pos ~ s(liveness, 3) + s(tempo,1)+ s(acousticness,2) + s(instrumentalness,3) + s(danceability,2) + s(duration_ms,3)+ s(loudness,1)+ s(valence,1), data = df1)
summary(gam4) # time signature
gam5 <- gam(peak_pos ~ s(liveness, 3) + s(tempo,1) + s(instrumentalness,3) + s(danceability,2) + s(duration_ms,3)+ s(loudness,1)+ s(valence,1), data = df1)
summary(gam4) # time signature
gam5 <- gam(peak_pos ~ s(liveness, 3) + s(tempo,1) + s(instrumentalness,3) + s(danceability,2) + s(duration_ms,3)+ s(loudness,1)+ s(valence,1), data = df1)
summary(gam5) # time signature
cv.error.10 <- cv.glm(na.omit(df1), fit, K=100)
cv.error.10$delta # Linear Model
cv.error.10 <- cv.glm(na.omit(df1), gam1, K=100)
cv.error.10$delta # Polynomial Model
cv.error.10 <- cv.glm(na.omit(df1), gam2, K=100)
cv.error.10$delta # Generalized Additive Model with all features
cv.error.10 <- cv.glm(na.omit(df1), gam5, K=100)
cv.error.10$delta # Generalized Additive Model with removed features
lin <- glm(peak_pos ~ energy + liveness + tempo + acousticness + instrumentalness + time_signature + danceability + duration_ms + loudness + valence, data = df1)
cv.error.10 <- cv.glm(na.omit(df1), lin, K=100)
cv.error.10$delta # Linear Model with all features
cv.error.10 <- cv.glm(na.omit(df1), fit, K=100)
cv.error.10$delta # Linear Model with removed features
v.error.10 <- cv.glm(na.omit(df1), lin, K=1000)
cv.error.10$delta # Linear Model with all features
cv.error.10 <- cv.glm(na.omit(df1), fit, K=1000)
cv.error.10$delta # Linear Model with removed features
Length(df1)
length(dr1)
length(df1)
nrow(df1)
cv.error.10 <- cv.glm(na.omit(df1), lin, K=1016)
cv.error.10$delta # Linear Model with all features
cv.error.10 <- cv.glm(na.omit(df1), fit, K=1016)
cv.error.10$delta # Linear Model with removed features
cv.error.10 <- cv.glm(na.omit(df1), gam1, K=1016)
cv.error.10$delta # Polynomial Model
cv.error.10 <- cv.glm(na.omit(df1), gam2, K=1016)
cv.error.10$delta # Generalized Additive Model with all features
7 * 16
cv.error.10 <- cv.glm(na.omit(df1), gam5, K=1016) # GAM with removed features
cv.error.10$delta # MSE =
p <- ggplot(df1, aes(x=df1$valence, y=df1$peak_pos)) +
theme_bw() +
geom_point(size=1, col="violet") +
geom_smooth(method="gam", color = "black") +
labs(subtitle="Valence Vs Peak Position",
y="Peak Position",
x="Valence",
title="",
caption = "Source: Billboard and Spotify")
print(p)
p <- ggplot(df1, aes(x=valence, y=peak_pos)) +
theme_bw() +
geom_point(size=1, col="violet") +
geom_smooth(method="gam", color = "black") +
labs(subtitle="Valence Vs Peak Position",
y="Peak Position",
x="Valence",
title="",
caption = "Source: Billboard and Spotify")
print(p)
barYear <- aggregate(df1[, 15], list(df1$year), median)
p <- ggplot(barYear, aes(x=Group.1, y= x / 1000)) +
theme_bw() +
geom_point(size=3, col="#40E0D0") +
geom_smooth(method="loess", color = "grey", size =.5) +
labs(subtitle="Year vs Duration",
y="Duration",
x="Year",
title="",
caption = "Source: Billboard and Spotify")
print(p)
barYear <- aggregate(df1[, 17], list(df1$year), median)
p <- ggplot(barYear, aes(x=Group.1, y=x)) +
theme_bw() +
geom_point(size=3, col="violet") +
geom_smooth(method="loess", color = "grey", size = .5) +
labs(subtitle="Year vs Valence (happiness)",
y="Median Valence",
x="Year",
title="",
caption = "Source: Billboard and Spotify")
print(p)
p <- ggplot(df1, aes(x=valence, y=peak_pos)) +
theme_bw() +
geom_point(size=1, col="violet") +
geom_smooth(method="gam", color = "black") +
labs(subtitle="Valence (happiness) Vs Peak Position",
y="Peak Position",
x="Valence",
title="",
caption = "Source: Billboard and Spotify")
print(p)
barYear <- aggregate(df1[, 15], list(df1$year), median)
p <- ggplot(barYear, aes(x=Group.1, y= x / 1000)) +
theme_bw() +
geom_point(size=3, col="#40E0D0") +
geom_smooth(method="loess", color = "grey", size =.5) +
labs(subtitle="Year vs Duration",
y="Duration (seconds)",
x="Year",
title="",
caption = "Source: Billboard and Spotify")
print(p)
barYear <- aggregate(df1[, 15], list(df1$year), median)
p <- ggplot(barYear, aes(x=Group.1, y= x / 1000)) +
theme_bw() +
geom_point(size=3, col="#40E0D0") +
labs(subtitle="Year vs Duration",
y="Duration (seconds)",
x="Year",
title="",
caption = "Source: Billboard and Spotify")
print(p)
p <- ggplot(df1, aes(x=duration_ms / 1000, y=peak_pos)) +
theme_bw() +
geom_point(size=1, col="#40E0D0") +
geom_smooth(method="loess", color = "black") +
xlim(150, 310) +
labs(subtitle="Duration Vs Peak Position",
y="Peak Position",
x="Duration (seconds)",
title="",
caption = "Source: Billboard and Spotify")
print(p)
barYear <- aggregate(df1[, 13], list(df1$year), median)
p <- ggplot(barYear, aes(x=Group.1, y=x)) +
theme_bw() +
geom_point(size=3, col="orange") +
geom_smooth(method="loess", color = "grey", size=.5) +
labs(subtitle="Year vs Danceability",
y="Danceability",
x="Year",
title="",
caption = "Source: Billboard and Spotify")
print(p)
# Danceability
p <- ggplot(df1, aes(x=danceability, y=peak_pos)) +
theme_bw() +
geom_point(size=1, col="orange") +
geom_smooth(method="loess", color = "black") +
xlim(.2, .9) +
labs(subtitle="Danceability Vs Peak Position",
y="Peak Position",
x="Danceability",
title="",
caption = "Source: Billboard and Spotify")
print(p)
source('C:/Users/Dylan Mumm/OneDrive - Clemson University/Clemson Files/2018 - Fall/CPSC 4300 - Data Science/Project/Billboard Final (Parks, Mumm, Selzer).r', echo=TRUE)
data = read.csv("Billboard_2000-2018+Spotify.csv", header = TRUE, stringsAsFactors = FALSE )
